import{c as y,r as d,j as l,M as x,Q as k,s as g}from"./index-B4rlpnaX.js";import{u as b}from"./useQuery-IeOZhcoX.js";import{u as h}from"./useInfiniteQuery-C7m7CRYj.js";import{T}from"./track-item-Du8u3WZ9.js";import{u as P}from"./usePlaySong-oiUfwSeH.js";import{B as S}from"./better-virtual-screen-Dwpf5q9c.js";import"./useBaseQuery-Btd2Joty.js";import"./context-menu-DrU09T6h.js";import"./smart-marquee-CLFMpira.js";import"./use-saved-playlists-CptLUfEK.js";/**
 * @license lucide-react v0.515.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M6 12c0-1.7.7-3.2 1.8-4.2",key:"oqkarx"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M18 12c0 1.7-.7 3.2-1.8 4.2",key:"1eah9h"}]],M=y("disc-3",_);function N(o,u="US"){const{data:a,isLoading:n}=b({queryKey:[k.album.GET,o],queryFn:()=>g.albums.get(o,u)}),{data:c=[],hasNextPage:s,fetchNextPage:i}=h({queryKey:[k.album.TRACKS,o],initialPageParam:50,queryFn:({pageParam:e})=>g.albums.tracks(o,"US",50,e),getNextPageParam:e=>e.next?e.offset+50:void 0,enabled:a!==void 0&&a.tracks.next!==null,select:e=>e.pages.flatMap(t=>t.items)});return{tracks:d.useMemo(()=>[...a?a.tracks.items:[],...c].reduce((t,r)=>{const{disc_number:f=1}=r;return t[f-1]||t.push([]),t[f-1].push(r),t},[]),[a,c]).flatMap((e,t,r)=>r.length===1?e:[t,...e]),isLoading:n,albumData:a,fetchNextPage:i,hasNextPage:s}}function j(o){const{id:u}=o,a=P(),{tracks:n,isLoading:c,albumData:s,hasNextPage:i,fetchNextPage:m}=N(u),p=e=>{const{linked_from:t,uri:r}=e;s&&a({track:{...e,album:{...s,album_group:""},external_ids:{upc:"",ean:"",isrc:""},popularity:0},contextUri:s.uri,offset:t?t.uri:r})};return l.jsx(S,{loaded:n.length,loading:c,fetchNextPage:m,hasNextPage:i,children:({index:e,style:t})=>{const r=n[e];return typeof r=="number"?l.jsxs(x,{style:t,className:"pointer-events-none justify-start gap-2",icon:M,children:["Disc ",r+1]}):l.jsx(T,{track:{...r,...s?{album:{...s,album_group:""}}:{}},style:t,onClick:()=>p(r),showGoToAlbum:!1})}})}const R=d.memo(j);export{R as default};
