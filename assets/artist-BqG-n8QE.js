import{r as m,u as V,a as U,j as r,b as L,d as q,P as x,e as j,f as K,g as v,S as y,h as G,i as Q,s as p}from"./index-zkImxG3m.js";import{u as A}from"./useQuery-BBn5-uPB.js";import{u as $}from"./useInfiniteQuery-BkxfwnhH.js";import{T as B}from"./track-item-B8-7GquB.js";import{u as z}from"./usePlaySong-D4EF1Lxk.js";import{c as _,R as O,I as Y}from"./context-menu-t1MoUkal.js";import{A as H}from"./album-item-B-9LB-cr.js";import{B as J}from"./better-virtual-screen-DcI-7b1B.js";import{Q as g}from"./query-enum-DfYzJYz8.js";import"./smart-marquee-4jliwKgy.js";import"./use-saved-playlists-DgSTlIQN.js";var h="Tabs",[W,ye]=L(h,[_]),N=_(),[X,S]=W(h),C=m.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,onValueChange:a,defaultValue:i,orientation:s="horizontal",dir:l,activationMode:b="automatic",...c}=e,u=V(l),[d,f]=U({prop:o,onChange:a,defaultProp:i??"",caller:h});return r.jsx(X,{scope:n,baseId:q(),value:d,onValueChange:f,orientation:s,dir:u,activationMode:b,children:r.jsx(x.div,{dir:u,"data-orientation":s,...c,ref:t})})});C.displayName=h;var I="TabsList",F=m.forwardRef((e,t)=>{const{__scopeTabs:n,loop:o=!0,...a}=e,i=S(I,n),s=N(n);return r.jsx(O,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:o,children:r.jsx(x.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});F.displayName=I;var P="TabsTrigger",k=m.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,disabled:a=!1,...i}=e,s=S(P,n),l=N(n),b=D(s.baseId,o),c=M(s.baseId,o),u=o===s.value;return r.jsx(Y,{asChild:!0,...l,focusable:!a,active:u,children:r.jsx(x.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:b,...i,ref:t,onMouseDown:j(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?s.onValueChange(o):d.preventDefault()}),onKeyDown:j(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&s.onValueChange(o)}),onFocus:j(e.onFocus,()=>{const d=s.activationMode!=="manual";!u&&!a&&d&&s.onValueChange(o)})})})});k.displayName=P;var E="TabsContent",R=m.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,forceMount:a,children:i,...s}=e,l=S(E,n),b=D(l.baseId,o),c=M(l.baseId,o),u=o===l.value,d=m.useRef(u);return m.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),r.jsx(K,{present:a||u,children:({present:f})=>r.jsx(x.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":b,hidden:!f,id:c,tabIndex:0,...s,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&i})})});R.displayName=E;function D(e,t){return`${e}-trigger-${t}`}function M(e,t){return`${e}-content-${t}`}var Z=C,ee=F,te=k,re=R;function ae({className:e,...t}){return r.jsx(Z,{"data-slot":"tabs",className:v("flex flex-col",e),...t})}function se({className:e,children:t,...n}){return r.jsxs(ee,{...n,"data-slot":"tabs-list",className:v("inline-flex w-fit items-center divide-x-[0.125rem] divide-fg text-fg",e),children:[t,r.jsx("div",{className:"h-full flex-1 border-b-[0.125rem]"})]})}function T({className:e,...t}){return r.jsx(te,{"data-slot":"tabs-trigger",className:v("focus-visible:outline-ring text-foreground relative z-30 inline-flex items-center justify-center gap-1.5 px-2 py-0.5 pb-[0.25rem] text-xs whitespace-nowrap first:border-l-[0.125rem] last:border-r-[0.125rem] hover:cursor-pointer disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-bg data-[state=active]:text-fg [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","after:absolute after:bottom-0 after:h-0 after:w-full after:border-b-[0.125rem] after:border-b-fg after:content-[''] data-[state=active]:after:border-b-transparent",e),...t})}function w({className:e,...t}){return r.jsx(re,{"data-slot":"tabs-content",className:v("flex-1 outline-none",e),...t})}const oe=["album","single","appears_on","compilation"];function ne(e){const{id:t}=e,[n,o]=m.useState("album"),{data:a=[],isLoading:i,hasNextPage:s,fetchNextPage:l}=$({queryKey:[g.artist.ALBUMS,n,t],queryFn:({pageParam:c})=>p.artists.albums(t,n,"US",50,c),initialPageParam:0,placeholderData:c=>c,getNextPageParam:c=>c.next?c.offset+50:void 0,select:c=>c.pages.flatMap(u=>u.items)}),b=c=>()=>o(c);return r.jsx(w,{value:"ablums",children:r.jsx(J,{loaded:a.length+1,loading:i,hasNextPage:s,fetchNextPage:l,children:({index:c,style:u})=>{if(c===0)return r.jsx("div",{className:"flex h-8 flex-row items-center gap-1",style:u,children:oe.map(f=>r.jsx("button",{onClick:b(f),className:v("h-min rounded-full border-[0.0625rem] border-fg px-1.5 py-0.25 text-xs whitespace-nowrap text-fg capitalize hover:cursor-pointer",n===f&&"bg-fg text-bg"),children:f.replaceAll("_"," ")},f))});const d=a[c-1];return r.jsx(H,{album:d,style:u})}})})}function ie(e){const{id:t}=e,n=z(),{data:o=[],isLoading:a}=A({queryKey:[g.artist.TRACKS,t],queryFn:()=>p.artists.topTracks(t,"US"),select:s=>s.tracks}),i=s=>{o.length!==0&&n({track:o[s],uris:o.map(l=>l.uri),offset:s})};return r.jsx(y,{loading:a,asChild:!0,children:r.jsx(w,{value:"tracks",children:o.map((s,l)=>r.jsx(B,{trackNumber:l+1,track:s,onClick:()=>i(l)},l))})})}function le(e){const t=G(),{data:n,refetch:o}=A({queryKey:[g.artist.IS_SAVED,e],initialData:[!1],queryFn:()=>p.currentUser.followsArtistsOrUsers([e],"artist"),select:i=>i[0]}),{mutate:a}=Q({mutationFn:async()=>{const i=n?"unfollowArtistsOrUsers":"followArtistsOrUsers";return t.setQueryData([g.artist.IS_SAVED,e],s=>[!s[0]]),await p.currentUser[i]([e],"artist"),{isFollowed:n}},onError:(i,s,l)=>{t.setQueryData([g.artist.IS_SAVED,e],[!!(l!=null&&l.isFollowed)])},onSuccess:()=>{setTimeout(o,500),t.invalidateQueries({queryKey:[g.artist.SAVED_LIST]})}});return{isFollowed:n,toggledFollowed:a}}function ce(e){const{id:t}=e,{isFollowed:n,toggledFollowed:o}=le(t),{data:a,isLoading:i}=A({queryKey:[g.artist.ABOUT,t],queryFn:()=>p.artists.get(t)});return r.jsx(y,{loading:i,asChild:!0,children:r.jsxs(w,{value:"about",className:"grid auto-rows-auto grid-cols-[auto_1fr] grid-rows-[auto_1fr] gap-2",children:[r.jsx("img",{className:"row-span-full size-30 border-[0.125rem] border-fg object-cover object-center",src:a==null?void 0:a.images[0].url}),r.jsx("button",{onClick:()=>o(),children:String(n)}),r.jsx("p",{className:"text-xl",children:a==null?void 0:a.name}),r.jsxs("p",{className:"col-start-2 row-start-2",children:[a==null?void 0:a.followers.total," followers"]})]})})}function ue(e){const{id:t}=e;return r.jsx(y,{asChild:!0,className:"overflow-hidden pt-0",children:r.jsxs(ae,{defaultValue:"tracks",children:[r.jsxs(se,{className:"w-full",children:[r.jsx(T,{value:"tracks",children:"Top Songs"}),r.jsx(T,{value:"ablums",children:"Albums"}),r.jsx(T,{value:"about",children:"About"})]}),r.jsx(ce,{id:t}),r.jsx(ie,{id:t}),r.jsx(ne,{id:t})]})})}const Ae=m.memo(ue);export{Ae as default};
