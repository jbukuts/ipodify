import{r as a,j as s,R as k,g as f,T as P,n as C,o as A,k as S,l as T,m as M,p as R,i as _,s as z,S as p,q as x}from"./index-xGhqjDPN.js";import{B as h}from"./smart-marquee-C43tEUfe.js";function E({className:e,defaultValue:r,value:l,min:o=0,max:n=100,...i}){const c=a.useMemo(()=>Array.isArray(l)?l:Array.isArray(r)?r:[o,n],[l,r,o,n]);return s.jsxs(k,{"data-slot":"slider",defaultValue:r,value:l,min:o,max:n,className:f("group relative flex w-full touch-none items-center select-none hover:cursor-pointer data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[s.jsx(P,{"data-slot":"slider-track",className:f("relative grow overflow-hidden rounded-full border-[0.125rem] bg-bg group-hover:rounded-none data-[orientation=horizontal]:h-5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:s.jsx(C,{"data-slot":"slider-range",className:f("absolute bg-fg group-hover:bg-fg/50 data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:c.length},(u,m)=>s.jsx(A,{"data-slot":"slider-thumb",className:"block size-3 shrink-0 rotate-45 bg-fg opacity-0 shadow-sm group-hover:opacity-100 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},m))]})}function q(){const{item:e,progress:r,isPlaying:l,refetch:o}=S(T(({item:t,progress:d,isPlaying:j,refetch:N})=>({progress:d,item:t,isPlaying:j,refetch:N}))),n=M(),[i,c]=a.useState(r),u=a.useRef(!1);R(()=>{c(t=>{const d=t+1e3;return e&&d>=e.duration_ms?(o(),0):d})},l?1e3:null),a.useEffect(()=>{o()},[]),a.useEffect(()=>{u.current||c(r)},[r]);const{mutate:m}=_({mutationFn:t=>z.player.seekToPosition(t),onSettled:()=>{setTimeout(o,500)}}),b=a.useCallback(()=>{!e||!("artists"in e)||window.open(`https://www.google.com/search?q=${encodeURI(e.name+" "+e.artists[0].name+" lyrics")}`)},[e]),g=a.useCallback(()=>{!e||!("album"in e)||n(e.album.name,"Album",{id:e.album.id})()},[e,n]),w=a.useMemo(()=>s.jsx("span",{className:"hover:cursor-pointer hover:underline",onClick:b,children:e==null?void 0:e.name}),[e]),y=a.useMemo(()=>e&&"album"in e&&s.jsx("span",{className:"hover:cursor-pointer hover:underline",onClick:g,children:e.album.name}),[e,g]),v=a.useMemo(()=>e&&"artists"in e?e.artists.flatMap(t=>[s.jsx("span",{role:"button",className:"hover:cursor-pointer hover:underline",onClick:n(t.name,"Artist",{id:t.id}),children:t.name},t.id),","]).slice(0,-1):[],[e,n]);return e===null?s.jsx(p,{className:"flex flex-col items-center justify-center text-fg",children:"Nothing is currently playing"}):s.jsxs(p,{className:"flex flex-col items-center justify-between gap-y-2 text-fg",children:[s.jsxs("div",{className:"flex w-full grow flex-col items-center justify-center gap-y-2 overflow-clip",children:[s.jsx(h,{wrapperClassName:"w-full",className:"text-center",autoPlay:!0,children:w}),"album"in e&&s.jsx(h,{autoPlay:!0,wrapperClassName:"w-full",className:"text-center",children:y}),"artists"in e&&s.jsx(h,{autoPlay:!0,wrapperClassName:"w-full",className:"text-center",children:v})]}),s.jsx(E,{onPointerDown:()=>u.current=!0,onPointerUp:()=>u.current=!1,onValueChange:t=>c(t[0]),onValueCommit:t=>m(t[0]),value:[i],max:e==null?void 0:e.duration_ms,min:0,className:"w-[95%]"}),s.jsxs("div",{className:"mb-3 flex w-[95%] justify-between",children:[s.jsx("p",{children:x(i)}),s.jsxs("p",{children:["-",x(((e==null?void 0:e.duration_ms)??0)-i)]})]})]})}const D=a.memo(q);export{D as default};
