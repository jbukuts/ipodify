import{j as m,M as k,Q as d,s as f}from"./index-DfWu0XcN.js";import{u as g}from"./useQuery-Cj0VkjqC.js";import{u as P}from"./useInfiniteQuery-B8I5qTvi.js";import{B as x}from"./better-virtual-screen-mtlyGHmd.js";import{u as h,T as S}from"./usePlaySong-CnFkfI_C.js";import"./useBaseQuery-DOTW683a.js";import"./context-menu-C80MbDdp.js";import"./smart-marquee-BcDRQkC3.js";import"./use-saved-playlists-C1eySg40.js";function T(r){const{data:t,isLoading:o}=g({queryKey:[d.playlist.GET,r],queryFn:()=>f.playlists.getPlaylist(r,"US")}),{data:s,fetchNextPage:n,hasNextPage:l}=P({queryKey:[d.playlist.TRACKS,r],queryFn:({pageParam:e})=>f.playlists.getPlaylistItems(r,"US",void 0,50,e),initialPageParam:100,getNextPageParam:e=>e.next?e.offset+50:void 0,enabled:t!==void 0&&t.tracks.next!==null}),{data:i}=g({queryKey:[d.user.PROFILE],queryFn:()=>f.currentUser.profile()}),u=[...t?t.tracks.items:[],...s?s.pages.flatMap(e=>e.items):[]];return{canModify:(i==null?void 0:i.id)===(t==null?void 0:t.owner.id)||(t==null?void 0:t.collaborative),playlist:t,tracks:u,isLoading:o,fetchNextPage:n,hasNextPage:l}}function b(r){const{id:t}=r,o=h(),{tracks:s,playlist:n,isLoading:l,hasNextPage:i,fetchNextPage:u,canModify:y}=T(t),e=a=>{!n||s.length===0||o({contextUri:n.uri,offset:a.linked_from?a.linked_from.uri:a.uri})};return m.jsx(x,{hasNextPage:i,loading:l,loaded:s.length,fetchNextPage:u,children:({index:a,style:p})=>{const{track:c}=s[a];return c===null?m.jsxs(k,{style:p,disabled:!0,icon:!1,children:[a+1,"."]}):m.jsx(S,{playlistId:y?t:void 0,track:c,trackNumber:a+1,style:p,onClick:()=>e(c)})}})}export{b as default};
